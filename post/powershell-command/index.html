<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        PowerShell Commands for Windows Server Admins
    </title>
    <link rel="icon" href="/dulkanggg/images/logo.png" type="image/png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/dulkanggg/css/style.css">
</head>

<body>
    <div class="container">
        <header>
            <a href="/dulkanggg/" class="logo">
                <img src="/dulkanggg/images/logo.png" alt="Logo"
                    style="height: 40px; vertical-align: middle; margin-right: 10px;">
                Dulkanggg's Corner
            </a>
            <nav>
                <a href="/dulkanggg/">Home</a>
                <a href="/dulkanggg/search.html">Search</a>
                <a href="/dulkanggg/about">About</a>
                <a href="/dulkanggg/rss">RSS</a>
            </nav>
        </header>

    <article class="post-content">
        <h1 style="color: #e2b714;">
            PowerShell Commands for Windows Server Admins
        </h1>
        <div style="color: var(--accent-color); margin-bottom: 20px;">
            <span>
                2025-12-04
            </span>
            
                | Tags:
                
                    <a href="/dulkanggg/tags/windows"
                        style="color: var(--accent-color); text-decoration: underline;">
                        windows
                    </a>
                    
                    <a href="/dulkanggg/tags/server"
                        style="color: var(--accent-color); text-decoration: underline;">
                        server
                    </a>
                    
                    <a href="/dulkanggg/tags/automation"
                        style="color: var(--accent-color); text-decoration: underline;">
                        automation
                    </a>
                    
                    <a href="/dulkanggg/tags/bilingual"
                        style="color: var(--accent-color); text-decoration: underline;">
                        bilingual
                    </a>
                    
                        
        </div>

        <div>
            <blockquote>
<p><em>üáªüá≥ B·∫£n ti·∫øng Vi·ªát n·∫±m ·ªü ph√≠a d∆∞·ªõi b√†i vi·∫øt (Vietnamese version is available below).</em></p>
</blockquote>
<hr>
<h3>Essential PowerShell &quot;Lifesaver&quot; Commands for Windows Server Admins</h3>
<p>Hello everyone. Today, I‚Äôd like to share and expand on a list of extremely useful PowerShell commands. Why use PowerShell on Windows Server? Because when you are managing dozens or hundreds of servers, clicking through individual GUI windows is impossible and incredibly slow. PowerShell allows you to operate quickly, accurately, and makes automation easy.</p>
<p>Below is a compiled list that includes both basic file operations and advanced system administration commands.</p>
<h3>1. File System &amp; Storage Management</h3>
<p><strong>Calculate folder size instantly</strong></p>
<p>On a Server, right-clicking Properties to check the size of a log folder or user profile can take forever. Use this command to calculate it immediately:</p>
<pre><code class="language-powershell">&quot;{0:N2} GB&quot; -f ((Get-ChildItem C:\inetpub\logs\ -Recurse | Measure-Object -Property Length -Sum -ErrorAction Stop).Sum / 1GB)
</code></pre>
<p>(This command recursively calculates the total size and converts it to GB, which is very handy for checking which folders are consuming your disk space).</p>
<p><strong>Search content in files (&quot;Grep&quot; for Windows)</strong></p>
<p>Need to find a specific error log or a misconfiguration hidden in dozens of text files? Don‚Äôt open them one by one.</p>
<pre><code class="language-powershell">Select-String -Path C:\Windows\System32\LogFiles\*.log -Pattern &quot;Error 500&quot;
</code></pre>
<h3>2. Service and Process Management</h3>
<p>This is a daily task for any admin. Instead of opening services.msc or Task Manager, you can do it much faster here.</p>
<p><strong>Check and Restart a stuck Service</strong></p>
<p>Example: The Web Server (IIS) service is unresponsive.</p>
<pre><code class="language-powershell"># Check status
Get-Service -Name W3SVC

# Restart immediately
Restart-Service -Name W3SVC -Force
</code></pre>
<p><strong>Find and &quot;Kill&quot; stubborn processes</strong></p>
<p>Is an application eating up too much RAM and refusing to close?</p>
<pre><code class="language-powershell"># Find process by name
Get-Process -Name &quot;notepad&quot;

# Force stop the process (Equivalent to End Task)
Stop-Process -Name &quot;notepad&quot; -Force
</code></pre>
<h3>3. Network &amp; Connectivity Checks</h3>
<p>On Windows Server, network debugging is critical. The ping command isn&#39;t enough because it doesn&#39;t check specific ports.</p>
<p><strong>Check Ports (Telnet Alternative)</strong></p>
<p>The Test-NetConnection command (alias: tnc) is the most powerful tool to check if your Server can reach a Database or another Web Server.</p>
<pre><code class="language-powershell"># Check if the server 192.168.1.10 has port 80 open
Test-NetConnection -ComputerName 192.168.1.10 -Port 80
</code></pre>
<p><strong>View IP information cleanly</strong></p>
<p>Instead of ipconfig /all which outputs too much text, this command gives a cleaner view of your Interfaces:</p>
<pre><code class="language-powershell">Get-NetIPAddress | Format-Table InterfaceAlias, IPAddress, PrefixLength
</code></pre>
<h3>4. System Event Logs</h3>
<p>Reading Event Viewer with the naked eye is exhausting. Filter it using PowerShell instead.</p>
<p><strong>Get the 10 most recent system errors</strong></p>
<p>This helps you quickly grasp the server&#39;s health status immediately after logging in.</p>
<pre><code class="language-powershell">Get-EventLog -LogName System -EntryType Error -Newest 10
</code></pre>
<h3>5. Remote Management</h3>
<p>This is the &quot;ultimate weapon&quot; of Windows Server. You don&#39;t need to Remote Desktop (RDP) into a server just to run a few commands.</p>
<p><strong>Connect directly to another Server&#39;s session</strong></p>
<p>This feature is called PowerShell Remoting (PSSession).</p>
<pre><code class="language-powershell"># Open a session to Server01
Enter-PSSession -ComputerName Server01 -Credential (Get-Credential)
</code></pre>
<p>After running this, your command prompt will change to <code>[Server01]: PS C:\&gt;</code>, meaning every command you type is now running on the remote machine.</p>
<h3>6. Updates &amp; Security</h3>
<p><strong>Check installed HotFixes</strong></p>
<p>Essential for verifying if your Server has been patched with the latest security updates.</p>
<pre><code class="language-powershell">Get-HotFix | Sort-Object InstalledOn -Descending | Select-Object -First 10
</code></pre>
<p><strong>Run as Admin for a specific application</strong></p>
<p>Similar to the runas command, but this is how you handle it in an object-oriented environment:</p>
<pre><code class="language-powershell">Start-Process powershell -Verb RunAs
</code></pre>
<h3>Quick Tip: Save as a Script</h3>
<p>If you frequently run a sequence of commands (e.g., Stop service -&gt; Delete logs -&gt; Start service), save them into a <code>.ps1</code> file.</p>
<p>Don&#39;t forget to check the Execution Policy as mentioned in previous posts:</p>
<pre><code class="language-powershell">Set-ExecutionPolicy RemoteSigned
</code></pre>
<p>I hope this expanded list helps with your system administration tasks. Please comment below if you have any other &quot;go-to&quot; commands!</p>
<hr>
<h3>T·ªïng h·ª£p c√°c l·ªánh PowerShell &quot;C·ª©u c√°nh&quot; cho Qu·∫£n tr·ªã vi√™n Windows Server</h3>
<p>Ch√†o m·ªçi ng∆∞·ªùi. H√¥m nay m√¨nh mu·ªën chia s·∫ª v√† m·ªü r·ªông th√™m danh s√°ch c√°c l·ªánh PowerShell c·ª±c k·ª≥ h·ªØu √≠ch. T·∫°i sao l·∫°i l√† PowerShell tr√™n Windows Server? V√¨ khi qu·∫£n l√Ω h√†ng ch·ª•c, h√†ng trƒÉm server, vi·ªác click chu·ªôt qua t·ª´ng c·ª≠a s·ªï GUI l√† b·∫•t kh·∫£ thi v√† ch·∫≠m ch·∫°p. PowerShell gi√∫p b·∫°n thao t√°c nhanh, ch√≠nh x√°c v√† d·ªÖ d√†ng t·ª± ƒë·ªông h√≥a.</p>
<p>D∆∞·ªõi ƒë√¢y l√† danh s√°ch m√¨nh t·ªïng h·ª£p, bao g·ªìm c·∫£ c√°c thao t√°c file c∆° b·∫£n v√† c√°c l·ªánh qu·∫£n tr·ªã h·ªá th·ªëng n√¢ng cao.</p>
<h3>1. Qu·∫£n l√Ω File v√† Dung l∆∞·ª£ng (File System)</h3>
<p><strong>T√≠nh to√°n k√≠ch th∆∞·ªõc th∆∞ m·ª•c c·ª±c nhanh</strong></p>
<p>Tr√™n Server, vi·ªác chu·ªôt ph·∫£i ch·ªçn Properties ƒë·ªÉ xem dung l∆∞·ª£ng th∆∞ m·ª•c log ho·∫∑c user profile r·∫•t m·∫•t th·ªùi gian. H√£y d√πng l·ªánh n√†y ƒë·ªÉ t√≠nh to√°n ngay l·∫≠p t·ª©c:</p>
<pre><code class="language-powershell">&quot;{0:N2} GB&quot; -f ((Get-ChildItem C:\inetpub\logs\ -Recurse | Measure-Object -Property Length -Sum -ErrorAction Stop).Sum / 1GB)
</code></pre>
<p>(L·ªánh n√†y ƒë·ªá quy t√≠nh t·ªïng dung l∆∞·ª£ng v√† ƒë·ªïi sang GB, r·∫•t ti·ªán ƒë·ªÉ ki·ªÉm tra th∆∞ m·ª•c n√†o ƒëang chi·∫øm d·ª•ng ·ªï c·ª©ng).</p>
<p><strong>T√¨m ki·∫øm n·ªôi dung trong file (Grep cho Windows)</strong></p>
<p>B·∫°n c·∫ßn t√¨m m·ªôt d√≤ng log l·ªói c·ª• th·ªÉ ho·∫∑c m·ªôt config sai trong h√†ng t√° file text? ƒê·ª´ng m·ªü t·ª´ng file m·ªôt.</p>
<pre><code class="language-powershell">Select-String -Path C:\Windows\System32\LogFiles\*.log -Pattern &quot;Error 500&quot;
</code></pre>
<h3>2. Qu·∫£n l√Ω D·ªãch v·ª• (Services) v√† Ti·∫øn tr√¨nh (Processes)</h3>
<p>ƒê√¢y l√† vi·ªác l√†m h√†ng ng√†y c·ªßa admin. Thay v√¨ m·ªü services.msc hay Task Manager, b·∫°n c√≥ th·ªÉ l√†m nhanh h∆°n nhi·ªÅu.</p>
<p><strong>Ki·ªÉm tra v√† Kh·ªüi ƒë·ªông l·∫°i Service b·ªã treo</strong></p>
<p>V√≠ d·ª•: Service Web Server (IIS) b·ªã ƒë∆°.</p>
<pre><code class="language-powershell"># Ki·ªÉm tra tr·∫°ng th√°i
Get-Service -Name W3SVC

# Kh·ªüi ƒë·ªông l·∫°i ngay l·∫≠p t·ª©c
Restart-Service -Name W3SVC -Force
</code></pre>
<p><strong>T√¨m v√† &quot;Kill&quot; ti·∫øn tr√¨nh c·ª©ng ƒë·∫ßu</strong></p>
<p>M·ªôt ·ª©ng d·ª•ng chi·∫øm qu√° nhi·ªÅu RAM v√† kh√¥ng ch·ªãu t·∫Øt?</p>
<pre><code class="language-powershell"># T√¨m ti·∫øn tr√¨nh theo t√™n
Get-Process -Name &quot;notepad&quot;

# Bu·ªôc d·ª´ng ti·∫øn tr√¨nh (t∆∞∆°ng ƒë∆∞∆°ng End Task)
Stop-Process -Name &quot;notepad&quot; -Force
</code></pre>
<h3>3. Ki·ªÉm tra K·∫øt n·ªëi M·∫°ng (Network &amp; Connectivity)</h3>
<p>Tr√™n Windows Server, vi·ªác debug m·∫°ng l√† t·ªëi quan tr·ªçng. L·ªánh ping l√† ch∆∞a ƒë·ªß v√¨ n√≥ kh√¥ng ki·ªÉm tra ƒë∆∞·ª£c c·ªïng (port).</p>
<p><strong>Ki·ªÉm tra Port (Thay th·∫ø Telnet)</strong></p>
<p>L·ªánh Test-NetConnection (hay vi·∫øt t·∫Øt l√† tnc) l√† c√¥ng c·ª• m·∫°nh nh·∫•t ƒë·ªÉ ki·ªÉm tra xem Server c√≥ th√¥ng t·ªõi Database hay Web Server kh√°c kh√¥ng.</p>
<pre><code class="language-powershell"># Ki·ªÉm tra xem m√°y ch·ªß 192.168.1.10 c√≥ m·ªü port 80 kh√¥ng
Test-NetConnection -ComputerName 192.168.1.10 -Port 80
</code></pre>
<p><strong>Xem th√¥ng tin IP nhanh g·ªçn</strong></p>
<p>Thay v√¨ ipconfig /all ra qu√° nhi·ªÅu ch·ªØ, l·ªánh n√†y cho c√°i nh√¨n g·ªçn g√†ng h∆°n v·ªÅ c√°c Interface:</p>
<pre><code class="language-powershell">Get-NetIPAddress | Format-Table InterfaceAlias, IPAddress, PrefixLength
</code></pre>
<h3>4. Qu·∫£n l√Ω Nh·∫≠t k√Ω h·ªá th·ªëng (Event Logs)</h3>
<p>ƒê·ªçc Event Viewer b·∫±ng m·∫Øt th∆∞·ªùng r·∫•t m·ªèi m·∫Øt. H√£y l·ªçc n√≥ b·∫±ng PowerShell.</p>
<p><strong>L·∫•y 10 l·ªói g·∫ßn nh·∫•t trong h·ªá th·ªëng</strong></p>
<p>L·ªánh n√†y gi√∫p b·∫°n n·∫Øm b·∫Øt nhanh t√¨nh h√¨nh s·ª©c kh·ªèe c·ªßa Server ngay khi v·ª´a login.</p>
<pre><code class="language-powershell">Get-EventLog -LogName System -EntryType Error -Newest 10
</code></pre>
<h3>5. Qu·∫£n tr·ªã t·ª´ xa (Remote Management)</h3>
<p>ƒê√¢y l√† &quot;v≈© kh√≠&quot; m·∫°nh nh·∫•t c·ªßa Windows Server. B·∫°n kh√¥ng c·∫ßn Remote Desktop (RDP) v√†o server ch·ªâ ƒë·ªÉ ch·∫°y v√†i l·ªánh.</p>
<p><strong>K·∫øt n·ªëi tr·ª±c ti·∫øp v√†o phi√™n l√†m vi·ªác c·ªßa Server kh√°c</strong></p>
<p>T√≠nh nƒÉng n√†y g·ªçi l√† PowerShell Remoting (PSSession).</p>
<pre><code class="language-powershell"># M·ªü m·ªôt phi√™n k·∫øt n·ªëi t·ªõi Server01
Enter-PSSession -ComputerName Server01 -Credential (Get-Credential)
</code></pre>
<p>Sau khi ch·∫°y l·ªánh n√†y, d·∫•u nh·∫Øc l·ªánh c·ªßa b·∫°n s·∫Ω ƒë·ªïi th√†nh <code>[Server01]: PS C:\&gt;</code>, nghƒ©a l√† m·ªçi l·ªánh b·∫°n g√µ ƒë·ªÅu ƒëang ch·∫°y tr√™n m√°y kia.</p>
<h3>6. C·∫≠p nh·∫≠t v√† B·∫£o m·∫≠t</h3>
<p><strong>Ki·ªÉm tra c√°c b·∫£n v√° l·ªói (HotFix) ƒë√£ c√†i ƒë·∫∑t</strong></p>
<p>R·∫•t c·∫ßn thi·∫øt ƒë·ªÉ ki·ªÉm tra xem Server ƒë√£ ƒë∆∞·ª£c patch l·ªó h·ªïng b·∫£o m·∫≠t m·ªõi nh·∫•t ch∆∞a.</p>
<pre><code class="language-powershell">Get-HotFix | Sort-Object InstalledOn -Descending | Select-Object -First 10
</code></pre>
<p><strong>Ch·∫°y quy·ªÅn Admin cho m·ªôt ·ª©ng d·ª•ng c·ª• th·ªÉ</strong></p>
<p>T∆∞∆°ng t·ª± l·ªánh runas b·∫°n ƒë√£ chia s·∫ª, nh∆∞ng ƒë√¢y l√† c√°ch g·ªçi trong m√¥i tr∆∞·ªùng object:</p>
<pre><code class="language-powershell">Start-Process powershell -Verb RunAs
</code></pre>
<h3>M·∫πo nh·ªè: L∆∞u l·∫°i th√†nh Script</h3>
<p>N·∫øu b·∫°n th∆∞·ªùng xuy√™n ph·∫£i ch·∫°y m·ªôt chu·ªói c√°c l·ªánh (v√≠ d·ª•: D·ª´ng service -&gt; X√≥a log -&gt; Start service), h√£y l∆∞u ch√∫ng v√†o file <code>.ps1</code>.</p>
<p>ƒê·ª´ng qu√™n ki·ªÉm tra Execution Policy nh∆∞ b√†i g·ªëc ƒë√£ ƒë·ªÅ c·∫≠p:</p>
<pre><code class="language-powershell">Set-ExecutionPolicy RemoteSigned
</code></pre>
<p>Hy v·ªçng danh s√°ch m·ªü r·ªông n√†y gi√∫p √≠ch cho c√¥ng vi·ªác qu·∫£n tr·ªã h·ªá th·ªëng c·ªßa b·∫°n. H√£y comment b√™n d∆∞·ªõi n·∫øu b·∫°n c√≥ nh·ªØng l·ªánh &quot;t·ªß&quot; n√†o kh√°c nh√©!</p>

        </div>
    </article>

    <div style="margin-top: 40px;">
        <a href="/dulkanggg/">&larr; Back to Home</a>
    </div>

    <footer>
    <p>&copy; 2025 Khang. All rights reserved.</p>
    <div class="social-links">
        <a href="https://github.com/khanchannn" target="_blank">GitHub</a>
        <a href="https://www.facebook.com/dulkanggg1504/" target="_blank">Facebook</a>
        <a href="mailto:dulkanggg1504@gmail.com">Email</a>
    </div>
</footer>
</div> <!-- End container -->
</body>

</html>